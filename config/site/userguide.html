<h1>dbpatcher - User's guide</h1>
<h3>Table of content</h3>
<p>
    <a href="#databaseDefinition">Database definition</a><br/>
    <a href="#commandLine">Running from command line</a><br/>
    <a href="#ant">Running from ant</a><br/>
</p>
<a name="databaseDefinition"></a><h3>Database definition</h3>
<p>
    A database is defined by a structure of directories (one per incremental step) containing SQL
    scrips as in the following example:
</p>
<ul>
    <li>1
        <ul>
            <li>script.sql</li>
        </ul>
    </li>
    <li>2
        <ul>
            <li>script1.sql</li>
            <li>script2.sql</li>
        </ul>
    </li>
</ul>
<p>
    Directory names must be parseable to an integer value. Steps are applied (e.g. the scripts
    inside the various directories are executed) following the order given by their names, for
    example: 1, 2, 3 or 01, 02, 03.
</p>
<p>
    Scripts are valid MySQL ones, for example:
</p>
<pre class="code"><code>-- Table MYTABLE, just for test
create table MYTABLE (
  ID bigint(20) not null primary key,
  NAME varchar(10) character set latin1 collate latin1_bin NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1;</code></pre>
<p>
    Commands are delimited by a semicolon (;) character. In case a different delimiter is needed 
    (for example when defining triggers) a new one can be specified using a special comment:
</p>
<pre class="code"><code>--DELIMITER "newdelimiter"</code></pre>
<p>
    As in the following example:
</p>
<pre class="code"><code>--DELIMITER "//"
-- Table MYTABLE, just for test
create table MYTABLE (
  ID bigint(20) not null primary key,
  NAME varchar(10) character set latin1 collate latin1_bin NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1//</code></pre>
<a name="commandLine"></a><h3>Running from command line</h3>
<p>
    TODO.
</p>
<a name="ant"></a><h3>Running from ant</h3>
<p>
    To use the task you must include in the classpath both <code>dbpatcher.jar</code> and all its
    dependencies. Dependencies must be in the classpath also when using the standalone jar.<br/>
    To use the task in a buildfile you need the following <code>taskdef</code> declaration:
</p>
<pre class="code"><code>&lt;taskdef name="dbpatcher" resource="net/robyf/dbpatcher/dbpatcher.properties" classpath="path.to.dbpatcher.jar" /&gt;</code></pre>
<h4>Parameters</h4>
<p>
    All parameters are required unless specified.
</p>
<table border="0" cellspacing="2" cellpadding="2" class="dependencies">
  <tr class="header">
    <th>Attribute</th>
    <th>Description</th>
  </tr>
  <tr class="even">
    <td>username</td>
    <td>Database user's username</td>
  </tr>
  <tr class="odd">
    <td>password</td>
    <td>Database user's password</td>
  </tr>
  <tr class="even">
    <td>database</td>
    <td>Database name</td>
  </tr>
  <tr class="odd">
    <td>schemaRoot</td>
    <td>Path to a database definition. It can be either a directory or a zip file</td>
  </tr>
  <tr class="even">
    <td>version</td>
    <td>Required increment version number (optional, by default all the increments are applied)</td>
  </tr>
  <tr class="odd">
    <td>rollbackIfError</td>
    <td>Specify if a database should be rolled back in case of error when applying an increment (optional, default = false)</td>
  </tr>
  <tr class="even">
    <td>simulationMode</td>
    <td>Specify is simulation mode must be used (optional, default = false)</td>
  </tr>
  <tr class="odd">
    <td>charset</td>
    <td>Character set used for reading the scripts (optional, default = ISO-8859-1)</td>
  </tr>
</table>
<!-- 
<p>
    It uses velocity for render pages and an xml file for defining the site navigation.
    More informations in the <a href="userguide.html">user guide</a>.
</p>
<p>
    <b>vsitegen</b> has been written for generating all the pages in the java section of this site.
    Its target was to build a website for a software looking close to the one generated by maven without using
    maven (which I think is evil because it forces developers to use a fixed directory structure).
</p>
<p>
    <b>vsitegen</b> is released under the terms of <a href="http://www.gnu.org/" target="_new">GNU</a>
    <a href="http://www.gnu.org/copyleft/gpl.html" target="_new">General Public License</a>.
</p>
-->
